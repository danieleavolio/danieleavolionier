import{s as K,a as Y,f as E,c as L,g as M,h as O,d as p,j as y,i as b,r as P,o as V,N as X,B as W,C as H,u as J}from"../chunks/scheduler.95a0eae5.js";import{S as Q,i as Z,b as tt,d as et,m as it,a as at,t as ot,e as st}from"../chunks/index.92efbcc7.js";import{S as nt}from"../chunks/SEO.94840f0c.js";const lt=async()=>({}),gt=Object.freeze(Object.defineProperty({__proto__:null,load:lt},Symbol.toStringTag,{value:"Module"}));function R(d){let n,r="Restart",o,a;return{c(){n=E("button"),n.textContent=r,this.h()},l(c){n=M(c,"BUTTON",{class:!0,"data-svelte-h":!0}),W(n)!=="svelte-joqhdu"&&(n.textContent=r),this.h()},h(){y(n,"class","svelte-1tloq5o")},m(c,u){b(c,n,u),o||(a=H(n,"click",d[1]),o=!0)},p:J,d(c){c&&p(n),o=!1,a()}}}function rt(d){let n,r,o,a,c,u;n=new nt({props:{title:"End of the Lova",description:"End"}});let s=d[0]&&R(d);return{c(){tt(n.$$.fragment),r=Y(),o=E("div"),a=E("canvas"),c=Y(),s&&s.c(),this.h()},l(l){et(n.$$.fragment,l),r=L(l),o=M(l,"DIV",{class:!0});var i=O(o);a=M(i,"CANVAS",{id:!0,class:!0}),O(a).forEach(p),c=L(i),s&&s.l(i),i.forEach(p),this.h()},h(){y(a,"id","gameCanvas"),y(a,"class","svelte-1tloq5o"),y(o,"class","game-container svelte-1tloq5o")},m(l,i){it(n,l,i),b(l,r,i),b(l,o,i),P(o,a),P(o,c),s&&s.m(o,null),u=!0},p(l,[i]){l[0]?s?s.p(l,i):(s=R(l),s.c(),s.m(o,null)):s&&(s.d(1),s=null)},i(l){u||(at(n.$$.fragment,l),u=!0)},o(l){ot(n.$$.fragment,l),u=!1},d(l){l&&(p(r),p(o)),st(n,l),s&&s.d()}}}function ht(d,n){return n.some(r=>{const o=d.x<r.x+r.width+50&&d.x+d.width+50>r.x,a=Math.abs(d.targetY-r.targetY)<r.height+30;return o&&a})}function ft(d,n,r){let o,a,c=!1,u=!1,s;const l=["Believe in yourself! Your journey matters.","Every setback is a setup for a comeback!","Your potential is limitless!","Dream big, stay strong!","You're capable of amazing things!","Never give up on your dreams!","Your story isn't over yet!","Rise and shine, try again!"],i={x:0,y:0,width:30,height:30,lives:3,lastShot:0,shootDelay:200};let x=[],_=[],f=[],g=0,S=0;const w={ArrowLeft:!1,ArrowRight:!1,ArrowUp:!1,ArrowDown:!1,Space:!1};function A(){!o||!a||s.currentTime>0||(s.play().catch(t=>console.log("Audio play failed:",t)),i.x=o.width/2-i.width/2,i.y=o.height-i.height-10,i.lives=3,x=[],f=[],g=0,S=0,c=!0,r(0,u=!1),requestAnimationFrame(C))}function q(){s.pause(),s.currentTime=0,A()}function G(){if(g-S<3e3||f.length>=4)return;const t=Math.random()<.3&&f.length===0,e=_.filter(h=>!f.some(v=>v.text===h));if(e.length===0)return;const m=()=>{const h=e[Math.floor(Math.random()*e.length)],v={x:100+Math.random()*(o.width-300),y:-30,targetY:50+Math.random()*150,width:100,height:30,text:h,health:5,lastShot:g,projectiles:[]};let D=0;for(;ht(v,f)&&D<10;)v.x=100+Math.random()*(o.width-300),v.targetY=50+Math.random()*150,D++;return v};f.push(m()),t&&f.push(m()),S=g}function T(t){t.code in w&&(t.preventDefault(),w[t.code]=!0)}function k(t){t.code in w&&(t.preventDefault(),w[t.code]=!1)}function B(t,e,m,h){a.beginPath(),a.moveTo(t+m/2,e),a.lineTo(t+m,e+h),a.lineTo(t,e+h),a.closePath(),a.fillStyle="white",a.fill()}function j(){w.ArrowLeft&&i.x>0&&(i.x-=5),w.ArrowRight&&i.x<o.width-i.width&&(i.x+=5),w.ArrowUp&&i.y>0&&(i.y-=5),w.ArrowDown&&i.y<o.height-i.height&&(i.y+=5)}function I(){w.Space&&g-i.lastShot>=i.shootDelay&&([0].forEach(e=>{x.push({x:i.x+i.width/2,y:i.y,width:15,height:25,active:!0,spreadX:e/10})}),i.lastShot=g)}function N(){x=x.filter(t=>(t.y-=4,t.x+=t.spreadX,t.y>0&&t.active)),f.forEach(t=>{t.y<t.targetY&&(t.y+=2),t.projectiles=t.projectiles.filter(e=>(e.angle=(e.angle||0)+.05,e.x+=Math.cos(e.angle)*60*.05,e.y+=1.2,e.y<o.height&&e.active&&e.x>0&&e.x<o.width)),g-t.lastShot>700&&(t.projectiles.push({x:t.x+t.width/2,y:t.y+t.height,width:30,height:30,active:!0,angle:Math.random()*Math.PI*2}),t.lastShot=g)})}function U(){x.forEach(t=>{f.forEach(e=>{t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y&&(e.health--,t.active=!1)})}),f.forEach(t=>{t.projectiles.forEach(e=>{e.x<i.x+i.width&&e.x+e.width>i.x&&e.y<i.y+i.height&&e.y+e.height>i.y&&(i.lives--,e.active=!1)})}),f=f.filter(t=>t.health>0),f.forEach(t=>{t.projectiles=t.projectiles.filter(e=>(x.some(h=>e.x<h.x+h.width&&e.x+e.width>h.x&&e.y<h.y+h.height&&e.y+e.height>h.y)&&(e.active=!1),e.active))})}function z(){a.clearRect(0,0,o.width,o.height),B(i.x,i.y,i.width,i.height),a.fillStyle="#00ff00",x.forEach(t=>{a.fillRect(t.x-t.width/2,t.y,t.width,t.height)}),f.forEach(t=>{a.fillStyle="white",a.font="20px Arial",a.fillText(t.text,t.x,t.y+20);for(let e=0;e<t.health;e++)a.fillRect(t.x+e*15,t.y-10,10,5);a.fillStyle="red",t.projectiles.forEach(e=>{a.beginPath(),a.arc(e.x,e.y,e.width/2,0,Math.PI*2),a.fill()})}),a.fillStyle="white",a.font="20px Arial",a.fillText(`Lives: ${i.lives}`,10,o.height-10)}async function F(){for(let e=0;e<1;e++){const m=l[Math.floor(Math.random()*l.length)],h=Math.random()*(o.width-200),v=Math.random()*(o.height-100);a.font=`${20+Math.random()*20}px Arial`,a.fillStyle=`hsl(${Math.random()*360}, 70%, 70%)`,a.fillText(m,h,v)}}function $(t){c=!1,r(0,u=!0);function e(){c||(a.clearRect(0,0,o.width,o.height),a.fillStyle="white",a.font="40px Arial",a.fillText(t,o.width/2-100,o.height/2),F(),requestAnimationFrame(e))}e()}function C(t){if(c){if(g=t,G(),j(),I(),N(),U(),z(),i.lives<=0){$("Game Over!");return}else if(f.length===0&&_.length===0){$("You Win!");return}requestAnimationFrame(C)}}return V(async()=>{const t=await fetch("/api/files");t.ok&&(_=await t.json()),o=document.getElementById("gameCanvas"),a=o.getContext("2d"),o.width=800,o.height=600,typeof window<"u"&&(window.addEventListener("keydown",T),window.addEventListener("keyup",k)),s=new Audio("/sounds/wotw.mp3"),s.volume=.8,document.body.click(),A()}),X(()=>{typeof window<"u"&&(window.removeEventListener("keydown",T),window.removeEventListener("keyup",k))}),[u,q]}class wt extends Q{constructor(n){super(),Z(this,n,ft,rt,K,{})}}export{wt as component,gt as universal};
