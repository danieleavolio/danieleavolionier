import{s as F,f as _,a as K,g as M,h as P,d as m,c as V,j as y,i as L,r as R,u as E,o as X,N as W,B as H,C as J}from"../chunks/scheduler.38e9bcec.js";import{S as Q,i as Z}from"../chunks/index.e37b2c25.js";const tt=async()=>({}),nt=Object.freeze(Object.defineProperty({__proto__:null,load:tt},Symbol.toStringTag,{value:"Module"}));function q(c){let o,l="Restart",s,i;return{c(){o=_("button"),o.textContent=l,this.h()},l(n){o=M(n,"BUTTON",{class:!0,"data-svelte-h":!0}),H(o)!=="svelte-joqhdu"&&(o.textContent=l),this.h()},h(){y(o,"class","svelte-1tloq5o")},m(n,f){L(n,o,f),s||(i=J(o,"click",c[1]),s=!0)},p:E,d(n){n&&m(o),s=!1,i()}}}function et(c){let o,l,s,i=c[0]&&q(c);return{c(){o=_("div"),l=_("canvas"),s=K(),i&&i.c(),this.h()},l(n){o=M(n,"DIV",{class:!0});var f=P(o);l=M(f,"CANVAS",{id:!0,class:!0}),P(l).forEach(m),s=V(f),i&&i.l(f),f.forEach(m),this.h()},h(){y(l,"id","gameCanvas"),y(l,"class","svelte-1tloq5o"),y(o,"class","game-container svelte-1tloq5o")},m(n,f){L(n,o,f),R(o,l),R(o,s),i&&i.m(o,null)},p(n,[f]){n[0]?i?i.p(n,f):(i=q(n),i.c(),i.m(o,null)):i&&(i.d(1),i=null)},i:E,o:E,d(n){n&&m(o),i&&i.d()}}}function it(c,o){return o.some(l=>{const s=c.x<l.x+l.width+50&&c.x+c.width+50>l.x,i=Math.abs(c.targetY-l.targetY)<l.height+30;return s&&i})}function at(c,o,l){let s,i,n=!1,f=!1,x;const A=["Believe in yourself! Your journey matters.","Every setback is a setup for a comeback!","Your potential is limitless!","Dream big, stay strong!","You're capable of amazing things!","Never give up on your dreams!","Your story isn't over yet!","Rise and shine, try again!"],a={x:0,y:0,width:30,height:30,lives:3,lastShot:0,shootDelay:200};let v=[],p=[],h=[],d=0,S=0;const u={ArrowLeft:!1,ArrowRight:!1,ArrowUp:!1,ArrowDown:!1,Space:!1};function b(){!s||!i||x.currentTime>0||(x.play().catch(t=>console.log("Audio play failed:",t)),a.x=s.width/2-a.width/2,a.y=s.height-a.height-10,a.lives=3,v=[],h=[],d=0,S=0,n=!0,l(0,f=!1),requestAnimationFrame(D))}function O(){x.pause(),x.currentTime=0,b()}function G(){if(d-S<3e3||h.length>=4)return;const t=Math.random()<.3&&h.length===0,e=p.filter(r=>!h.some(w=>w.text===r));if(e.length===0)return;const g=()=>{const r=e[Math.floor(Math.random()*e.length)],w={x:100+Math.random()*(s.width-300),y:-30,targetY:50+Math.random()*150,width:100,height:30,text:r,health:5,lastShot:d,projectiles:[]};let Y=0;for(;it(w,h)&&Y<10;)w.x=100+Math.random()*(s.width-300),w.targetY=50+Math.random()*150,Y++;return w};h.push(g()),t&&h.push(g()),S=d}function T(t){t.code in u&&(t.preventDefault(),u[t.code]=!0)}function k(t){t.code in u&&(t.preventDefault(),u[t.code]=!1)}function B(t,e,g,r){i.beginPath(),i.moveTo(t+g/2,e),i.lineTo(t+g,e+r),i.lineTo(t,e+r),i.closePath(),i.fillStyle="white",i.fill()}function $(){u.ArrowLeft&&a.x>0&&(a.x-=5),u.ArrowRight&&a.x<s.width-a.width&&(a.x+=5),u.ArrowUp&&a.y>0&&(a.y-=5),u.ArrowDown&&a.y<s.height-a.height&&(a.y+=5)}function j(){u.Space&&d-a.lastShot>=a.shootDelay&&([0].forEach(e=>{v.push({x:a.x+a.width/2,y:a.y,width:15,height:25,active:!0,spreadX:e/10})}),a.lastShot=d)}function I(){v=v.filter(t=>(t.y-=4,t.x+=t.spreadX,t.y>0&&t.active)),h.forEach(t=>{t.y<t.targetY&&(t.y+=2),t.projectiles=t.projectiles.filter(e=>(e.angle=(e.angle||0)+.05,e.x+=Math.cos(e.angle)*60*.05,e.y+=1.2,e.y<s.height&&e.active&&e.x>0&&e.x<s.width)),d-t.lastShot>700&&(t.projectiles.push({x:t.x+t.width/2,y:t.y+t.height,width:30,height:30,active:!0,angle:Math.random()*Math.PI*2}),t.lastShot=d)})}function N(){v.forEach(t=>{h.forEach(e=>{t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y&&(e.health--,t.active=!1)})}),h.forEach(t=>{t.projectiles.forEach(e=>{e.x<a.x+a.width&&e.x+e.width>a.x&&e.y<a.y+a.height&&e.y+e.height>a.y&&(a.lives--,e.active=!1)})}),h=h.filter(t=>t.health>0),h.forEach(t=>{t.projectiles=t.projectiles.filter(e=>(v.some(r=>e.x<r.x+r.width&&e.x+e.width>r.x&&e.y<r.y+r.height&&e.y+e.height>r.y)&&(e.active=!1),e.active))})}function U(){i.clearRect(0,0,s.width,s.height),B(a.x,a.y,a.width,a.height),i.fillStyle="#00ff00",v.forEach(t=>{i.fillRect(t.x-t.width/2,t.y,t.width,t.height)}),h.forEach(t=>{i.fillStyle="white",i.font="20px Arial",i.fillText(t.text,t.x,t.y+20);for(let e=0;e<t.health;e++)i.fillRect(t.x+e*15,t.y-10,10,5);i.fillStyle="red",t.projectiles.forEach(e=>{i.beginPath(),i.arc(e.x,e.y,e.width/2,0,Math.PI*2),i.fill()})}),i.fillStyle="white",i.font="20px Arial",i.fillText(`Lives: ${a.lives}`,10,s.height-10)}async function z(){for(let e=0;e<1;e++){const g=A[Math.floor(Math.random()*A.length)],r=Math.random()*(s.width-200),w=Math.random()*(s.height-100);i.font=`${20+Math.random()*20}px Arial`,i.fillStyle=`hsl(${Math.random()*360}, 70%, 70%)`,i.fillText(g,r,w)}}function C(t){n=!1,l(0,f=!0);function e(){n||(i.clearRect(0,0,s.width,s.height),i.fillStyle="white",i.font="40px Arial",i.fillText(t,s.width/2-100,s.height/2),z(),requestAnimationFrame(e))}e()}function D(t){if(n){if(d=t,G(),$(),j(),I(),N(),U(),a.lives<=0){C("Game Over!");return}else if(h.length===0&&p.length===0){C("You Win!");return}requestAnimationFrame(D)}}return X(async()=>{const t=await fetch("/api/files");t.ok&&(p=await t.json()),s=document.getElementById("gameCanvas"),i=s.getContext("2d"),s.width=800,s.height=600,typeof window<"u"&&(window.addEventListener("keydown",T),window.addEventListener("keyup",k)),x=new Audio("/sounds/wotw.mp3"),x.volume=.8,document.body.click(),b()}),W(()=>{typeof window<"u"&&(window.removeEventListener("keydown",T),window.removeEventListener("keyup",k))}),[f,O]}class lt extends Q{constructor(o){super(),Z(this,o,at,et,F,{})}}export{lt as component,nt as universal};
